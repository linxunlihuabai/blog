# http结构

起始行 + 头部 + 空行 + 实体 

# http的优缺点？

优点：

1. 简单、灵活、易于拓展
2. 可靠传输，因为HTTP是基于TCP的。
3. 无状态，每次http请求都是独立的，没有上下文信息，可以减少网络开销，减轻服务器压力

缺点：

1. 明文传输，http中的报文（主要指header）不是使用二进制数据，而是使用的文本数据。这样虽然利于调试，但也不安全，信息都暴露了。
2. 无状态，没错，无状态即是优点也是缺点，对于一些连续关联操作的场景，无状态就显得很麻烦了。
3. 队头阻塞问题，因为http是一发一收的“请求”-“响应”模式，这就形成了一个先进先出的串行队列。如果前面的请求很慢，就会阻塞后面的请求。

## 如何解决无状态的问题？

1. Cookie - Cookie是客户端保存状态的一种方式。客户端请求服务端，如果需要保存一份状态，那么服务端就用response把cookie发给客户端，浏览器会自动把这份Cookie存起来，然后下次请求就把这份Cookie带上发送给服务器，服务器就可以拼接cookie校验和获取信息了。
2. Session - Session是服务端保存状态的一种方式。当客户端发送了请求后，服务端会把客户端的一些状态信息存在session中。客户端再次请求时只需要从session中取出对应的状态信息就行。

## Cookie和Session的区别

1. Cookie保存在客户端，Session保存在服务端
2. Cookie只能保存ASCII，Session可以保存任意类型
3. Session比Cookie更安全，因为保存在服务端
4. Cookie有大小限制（4k）,Session没有大小限制


## 如何解决队头阻塞问题？

1. http1.1管线化

http1.1的管线化让请求可以并行发出，而不用等待前面的请求的响应。但是因为http1.1还是文本格式的，所以它没法判断响应的顺序，所以请求的响应还是得按顺序返回，并没有真正的解决阻塞问题，同时管线化在很多代理服务器中不好实现，因为默认是关闭状态的。

2. 并发连接

同时对一个域名发起多个TCP连接，用数量解决问题，但是浏览器对这个并发数量使用限制的，一般浏览器对同一个域名的限制是6~8个。

3. 域名分片

既然对一个域名有6个并发的限制，那就把资源放在多个域名下，这样就能突破并发限制了。

4. htt2 多路复用

http2采用了二进制分帧，把一个个请求和响应分解成一个个二进制帧，每一个帧中都有对应的流id，这样不同流id的帧就可以乱序发送，然后再另一端根据相同流id进行组合。因为流id是自增的，所以可以判断出顺序。这样一个TCP连接就可以同时发送多个http请求且不会阻塞了。

但是还是存在TCP队头阻塞的问题，因为TCP的超时重传机制，如果前一个请求的数据报丢失了，那么就需要等待超时重传，这时也会阻塞后面的请求。

5. HTTP3 (QUIC)

为了解决TCP队首阻塞的问题，在UDP的基础上实现了一套可靠的传输协议 QUIC。（TCP已经应用范围很广了，不可能改TCP的）这样一来就根本不用TCP了，那就自然没有TCP队头阻塞的问题咯。